<html>
<head>
  <title>图片缓存以及处理</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/276742; Windows/10.0.10240 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="539"/>
<h1>图片缓存以及处理</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2015/10/13 20:29</i></td></tr>
<tr><td><b>作者：</b></td><td><i>978823884@qq.com</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><h1 style="box-sizing: border-box; outline: none !important; font-size: 2.6em; margin: 1.2em 0px 0.6em; font-family: inherit; font-weight: bold; color: inherit; text-align: start;">图片缓存以及处理</h1><p style="box-sizing: border-box; outline: none !important; margin: 0px 0px 1.1em;">采用二次采样（缩小图片尺寸的方式）</p><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">1.步骤一，获取原始图片的宽高信息，用户与采样的计算<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);"><span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">1.1</span>创建<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">Options</span>，给BitmapFactory的内部解码器传入参数<br style="box-sizing: border-box; outline: none !important;"/></code></pre><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">    BitmapFactory.<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">Options</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">options</span>=<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">new</span> BitmapFactory.<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">Options</span>();<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);"><span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">1.2</span>设置<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">in</span>JustDecodeBounds来控制解码器，只进行图片宽高的获取，不会加载Bitmap，不占用内存，当使用这个参数，代表BitmapFactory.decodeXxxxx类似的方法，都不会返回Bitmap<br style="box-sizing: border-box; outline: none !important;"/></code></pre><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">    <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">options</span>.inJustDecodeBounds=<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">true</span>;<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);"><span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">1.3</span>解码，使用<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">Options</span>参数的设置  解码方式<br style="box-sizing: border-box; outline: none !important;"/></code></pre><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">    <span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">BitmapFactory</span>.decodeByteArray(<span style="box-sizing: border-box; outline: none !important;"><span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">data</span>,0,<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">data</span>.length,options);</span><br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">2.步骤二，根据图片的真实尺寸，与当前需要显示的尺寸，进行计算，生成图片采样率。<br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">2.1<br style="box-sizing: border-box; outline: none !important;"/></code></pre><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">    <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">int</span> picW=<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">options</span>.outWidth;<span style="box-sizing: border-box; outline: none !important; color: rgb(117, 113, 94);">//图片的宽</span><br style="box-sizing: border-box; outline: none !important;"/>    <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">int</span> picH=<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">options</span>.outHeight;<span style="box-sizing: border-box; outline: none !important; color: rgb(117, 113, 94);">//图片的高</span><br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">2.2 准备显示在手机上<br style="box-sizing: border-box; outline: none !important;"/>    尺寸是根据程序需要来设置的<br style="box-sizing: border-box; outline: none !important;"/></code></pre><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">    int reqW=<span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">128</span>//请求的宽度<br style="box-sizing: border-box; outline: none !important;"/>    int reqH=<span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">64</span>//<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">...</span>//测试数据<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">2.3计算，设置图片采样率<br style="box-sizing: border-box; outline: none !important;"/></code></pre><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">    <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">options</span>.inSampleSize= <span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">32</span> ;<span style="box-sizing: border-box; outline: none !important; color: rgb(117, 113, 94);">//宽度的1/32，高度的1/32 //测试，应用算法计算得出</span><br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">2.4开放解码，实际生成Bitmap<br style="box-sizing: border-box; outline: none !important;"/></code></pre><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">    <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">options</span>.inJustDecodeBounds=<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">false</span>;<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre></div><div style="box-sizing: border-box; outline: none !important; color: rgb(44, 63, 81); font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; font-size: 15.1111106872559px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);"><br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/><span style="box-sizing: border-box; outline: none !important;"><br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/><span style="box-sizing: border-box; outline: none !important;">2.5使用设置采样的参数来进行解码</span></span><br style="box-sizing: border-box; outline: none !important;"/></code></pre><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);">    ret=<span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">BitmapFactory</span>.decodeByteArray(<span style="box-sizing: border-box; outline: none !important;"><span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">data</span>,0,<span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">data</span>.length,options);</span><br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre><p style="box-sizing: border-box; outline: none !important; margin: 0px 0px 1.1em;">计算图片二次采样的采样率：</p><pre style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: 0.9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0px 0px 1.1em; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); border: 0px; border-radius: 5px; text-align: start; background: rgb(246, 246, 246);"><code style="box-sizing: border-box; outline: none !important; font-family: &apos;Source Code Pro&apos;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); white-space: pre-wrap; border-radius: 0px; display: block; background: rgb(35, 36, 31);"><span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">public</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">static</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">int</span> calculateInSampleSize(<br style="box-sizing: border-box; outline: none !important;"/>                                               BitmapFactory.Options options, <span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">int</span> reqWidth, <span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">int</span>  reqHeight) {<br style="box-sizing: border-box; outline: none !important;"/><span style="box-sizing: border-box; outline: none !important; color: rgb(117, 113, 94);">// Raw height and width of image</span><br style="box-sizing: border-box; outline: none !important;"/><span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">final</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">int</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(248, 248, 242);">height</span> = options.outHeight;<br style="box-sizing: border-box; outline: none !important;"/><span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">final</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">int</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(248, 248, 242);">width</span> = options.outWidth;<br style="box-sizing: border-box; outline: none !important;"/><span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">int</span> inSampleSize = <span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">1</span>;<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/><span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">if</span> (<span style="box-sizing: border-box; outline: none !important; color: rgb(248, 248, 242);">height</span> &gt; reqHeight || <span style="box-sizing: border-box; outline: none !important; color: rgb(248, 248, 242);">width</span> &gt; reqWidth) {<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/>    <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">final</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">int</span> halfHeight = <span style="box-sizing: border-box; outline: none !important; color: rgb(248, 248, 242);">height</span> / <span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">2</span>;<br style="box-sizing: border-box; outline: none !important;"/>    <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">final</span> <span style="box-sizing: border-box; outline: none !important; color: rgb(230, 219, 116);">int</span> halfWidth = <span style="box-sizing: border-box; outline: none !important; color: rgb(248, 248, 242);">width</span> / <span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">2</span>;<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/>     <span style="box-sizing: border-box; outline: none !important; color: rgb(117, 113, 94);">// Calculate the largest inSampleSize value that is a power of 2 and keeps both</span><br style="box-sizing: border-box; outline: none !important;"/>    <span style="box-sizing: border-box; outline: none !important; color: rgb(117, 113, 94);">// height and width larger than the requested height and width.</span><br style="box-sizing: border-box; outline: none !important;"/>    <span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">while</span> ((halfHeight / inSampleSize) &gt; reqHeight<br style="box-sizing: border-box; outline: none !important;"/>            &amp;&amp; (halfWidth / inSampleSize) &gt; reqWidth) {<br style="box-sizing: border-box; outline: none !important;"/>        inSampleSize *= <span style="box-sizing: border-box; outline: none !important; color: rgb(174, 129, 255);">2</span>;<br style="box-sizing: border-box; outline: none !important;"/>    }<br style="box-sizing: border-box; outline: none !important;"/>}<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/><span style="box-sizing: border-box; outline: none !important; color: rgb(249, 38, 114);">return</span> inSampleSize;}<br style="box-sizing: border-box; outline: none !important;"/><br style="box-sizing: border-box; outline: none !important;"/></code></pre><div style="box-sizing: border-box; outline: none !important; margin: 0px 0px 1.1em;"><div><img src="图片缓存以及处理_files/Image.png" type="image/png" alt="a.png" style="cursor: default;"/></div></div></div></span>
</div></body></html> 